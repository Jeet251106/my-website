<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pomodoro Timer</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Firebase SDKs -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
    import {
      getAuth,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      signOut,
      onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "databaseorwot.firebaseapp.com",
      databaseURL: "https://databaseorwot-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "databaseorwot",
      storageBucket: "databaseorwot.appspot.com",
      messagingSenderId: "669163374689",
      appId: "1:669163374689:web:ede81234a6a8b675d5c220"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    window.signup = async () => {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      try {
        await createUserWithEmailAndPassword(auth, email, password);
      } catch (err) {
        alert(err.message);
      }
    };

    window.login = async () => {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      try {
        await signInWithEmailAndPassword(auth, email, password);
      } catch (err) {
        alert(err.message);
      }
    };

    window.logout = async () => {
      await signOut(auth);
    };

    onAuthStateChanged(auth, (user) => {
      const authInputs = document.getElementById('authInputs');
      const authButtons = document.getElementById('authButtons');
      const logoutBtn = document.getElementById('logoutBtn');
      const appSection = document.getElementById('appSection');

      if (user) {
        authInputs.classList.add('hidden');
        authButtons.classList.add('hidden');
        logoutBtn.classList.remove('hidden');
        appSection.classList.remove('hidden');
      } else {
        authInputs.classList.remove('hidden');
        authButtons.classList.remove('hidden');
        logoutBtn.classList.add('hidden');
        appSection.classList.add('hidden');
      }
    });
  </script>
</head>

<body class="relative text-white min-h-screen bg-cover bg-center bg-no-repeat text-base"
  style="background-image: url('https://i.pinimg.com/originals/d8/55/ad/d855ad574a63b786b26c8229365c506e.gif');">

  <div class="absolute inset-0 bg-black bg-opacity-60 z-0"></div>

  <!-- Logout button top-right -->
  <div class="absolute top-4 right-4 z-20">
    <button onclick="logout()" id="logoutBtn" class="bg-red-600 px-4 py-2 rounded hidden text-sm">Log Out</button>
  </div>

  <!-- Content -->
  <div class="relative z-10 flex flex-col items-center justify-center space-y-6 p-4">

    <!-- Auth Section -->
    <div class="text-center" id="authSection">
      <div id="authInputs" class="space-y-2">
        <input type="email" id="email" placeholder="Email" class="p-2 rounded text-black w-full max-w-md text-base">
        <input type="password" id="password" placeholder="Password" class="p-2 rounded text-black w-full max-w-md text-base">
      </div>

      <div id="authButtons" class="space-x-2 mt-2">
        <button onclick="signup()" class="bg-blue-600 px-4 py-2 rounded text-base">Sign Up</button>
        <button onclick="login()" class="bg-green-600 px-4 py-2 rounded text-base">Log In</button>
      </div>
    </div>

    <!-- Main App Section -->
    <div id="appSection" class="hidden flex flex-col items-center space-y-6 w-full max-w-xl">

      <!-- Top Center Title -->
      <h1 class="text-4xl font-bold mt-4">Pomodoro Timer</h1>

      <!-- Timer -->
      <div class="text-center space-y-4">
        <div id="timer" class="text-6xl font-mono">25:00</div>
        <div class="space-x-2">
          <button onclick="setTime(25)" class="bg-blue-600 px-4 py-2 rounded">Pomodoro</button>
          <button onclick="setTime(5)" class="bg-green-600 px-4 py-2 rounded">Short Break</button>
          <button onclick="setTime(15)" class="bg-yellow-600 px-4 py-2 rounded">Long Break</button>
        </div>
        <div class="space-x-2">
          <button id="start" class="bg-teal-500 px-5 py-2 rounded">Start</button>
          <button id="reset" class="bg-gray-500 px-5 py-2 rounded">Reset</button>
        </div>
      </div>

      <!-- Challenge -->
      <div class="w-full max-w-md">
        <h2 class="text-2xl font-semibold mb-2">üéØ Challenge</h2>
        <input type="number" id="challengeCount" placeholder="Pomodoro count (e.g. 4)" class="w-full p-2 rounded text-black">
        <button onclick="startChallenge()" class="mt-2 bg-purple-600 px-4 py-2 rounded w-full">Start Challenge</button>
        <p id="challengeStatus" class="mt-2 text-sm text-green-300"></p>
      </div>

      <!-- To-Do List -->
      <div class="w-full max-w-md">
        <h2 class="text-2xl font-semibold mb-2">üìù To-Do List</h2>
        <div class="flex gap-2">
          <input id="todoInput" class="flex-1 p-2 rounded text-black" placeholder="Add a task">
          <button onclick="addTodo()" class="bg-indigo-500 px-4 py-2 rounded">Add</button>
        </div>
        <ul id="todoList" class="mt-4 space-y-2"></ul>
      </div>

      <!-- Spotify Embed -->
      <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/4Zjli1P13J5mmSCD5iKAXK?utm_source=generator"
        width="100%" height="200" frameborder="0" allowfullscreen=""
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy">
      </iframe>
    </div>

    <script src="pomodoro.js"></script>
    <script src="todo.js"></script>
    <script src="challenge.js"></script>
  </div>
</body>
</html>
